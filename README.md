## Обновление: переход на Detectron2 (коммерческое использование)

В проекте удалена зависимость от YOLOX. Инференс выполняется через Detectron2. Для соблюдения коммерческой лицензии требуется использовать веса, на которые у вас есть права (например, собственная тренировка или лицензированные коммерчески допустимые веса). Модельный зоопарк Detectron2 может поставляться с ограничениями на некоммерческое использование предобученных весов — не используйте их в проде.

### Установка

1) Установите PyTorch, совместимый с вашей системой (CPU/CUDA):

```bash
pip install --upgrade pip
pip install torch torchvision --index-url https://download.pytorch.org/whl/cu121
```

2) Установите Detectron2 (подберите колесо под вашу версию CUDA/torch):

```bash
pip install 'detectron2>=0.6'
```

3) Базовые зависимости:

```bash
pip install -r requirements.txt
```

### Запуск детекции с камеры

Обязателен путь к весам `--weights`, на которые у вас есть коммерческие права.

```bash
python -m src.camera_inference --source 0 --device cpu --conf 0.5 \
  --config COCO-Detection/retinanet_R_50_FPN_3x.yaml \
  --weights D:/models/retinanet_custom.pth
```

По умолчанию результаты фильтруют людей и животных. Изменить список можно в `src/d2_predictor.py` (`COCO_EXCLUDE_CLASSES`).

=======================
     * README.MD *
=======================

--После клонирования репозитория в Windows powershell, в корне проекта необходимо выполнить команду:
### .\download_models.ps1
- После выполнения создадутся папки models, assets, outputs
- Скачаются все модели (.pth, .onnx, .xml, .bin) и тестовое изображение dog.jpg;
- Сразу же установятся зависимости из requirements.txt
- Запустится inference_onnx.py, результат сохранится в outputs/.
- Также сразу обновится .gitignore, в него войдут папки с загруженными моделями
- В каждом проекте нужно заново разворачивать .\download_models.ps1

- Если Windows блокирует скрипты, включи разрешение выполнения в PowerShell (один раз от админа):
### Set-ExecutionPolicy -Scope CurrentUser -ExecutionPolicy RemoteSigned

- Запуск кода в терминале
### python minsocfacesai\src\camera_inference.py -m models\yolox_s.onnx --source 0 --conf 0.35 --iou 0.5`

### --source 1   если IVcam,   
### --source 0   если фронталка на пк 

### --conf 0.35 
- --conf: порог уверенности детекции.
- Каждая потенциальная рамка имеет оценку уверенности вероятность класса objectness×вероятность класса.
- Мы показываем только те боксы, у которых эта оценка ≥ conf.
- Чем выше conf, тем меньше ложных срабатываний, но и тем больше пропусков слабых объектов.
### --iou 0.5
- --iou: порог IoU для NMS (не‑максимального подавления).
- NMS удаляет перекрывающиеся боксы одного класса, оставляя самый уверенный.
- IoU — доля пересечения двух рамок. Если перекрытие ≥ iou, менее уверенная рамка удаляется.
- Чем ниже iou, тем агрессивнее удаляются пересечения; чем выше — больше пересекающихся боксов останется.
